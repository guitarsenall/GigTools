S:\will\documents\OneDrive\2024\gigtools\data\gigtools_notes.txt

                                                Tuesday, May 7, 2024 (11:58 AM)
OBJECTIVES:
    Refresh Python skills by creating some tools to help process my
    gig data.
        * Bigger goals:
            Prioritize songs for rehearsals
            Prioritize songs for repeat gigs
                (e.g., don't play what I played last month)
            Notify me when a guitar needs new strings
        * Baby steps:
            Script to reverse the song list since it comes
                backwards from OneNote
            Match mis-spelled song titles
                Idea: matching 2-character sequences exceeding
                a percentage threshold.
            Get gig data from Outlook and/or OneNote

+   Get python working again.

    *   Update PyScripter
        -   The update  REQUIRES that I install Python 3.7 or above.
            It is also 32-bit. After some researching, I think I want
            to go with 64-bit (default download).
        -   Download 64-bit PyScripter
                https://sourceforge.net/projects/pyscripter/
                PyScripter-4.3.4-x64-Setup.exe
            Don't install yet. First install Python.
        -   Download latest 64-bit version of Python from
                https://www.python.org/downloads/
                python-3.12.3-amd64.exe
            Install. Default.
            Verify at command prompt:
                >py
            Gives:
                Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45)
                [MSC v.1900 32 bit (Intel)] on win32
            That is an old version installed before.
            Where is it installed? Google. Here:
                C:\Users\Owner\AppData\Local\Programs\Python\Python312\
            Verify in command window:
                C:\Users\Owner>cd C:\Users\Owner\AppData\Local\Programs
                        \Python\Python312
                C:\Users\Owner\AppData\Local\Programs\Python\Python312>python
                Python 3.12.3 (tags/v3.12.3:f6650f9, Apr  9 2024, 14:05:25)
                    [MSC v.1938 64 bit (AMD64)] on win32
                Type "help", "copyright", "credits" or "license" for more
                    information.
            Looks good.
        -   Now install
                PyScripter-4.3.4-x64-Setup.exe
            It found Python 3.12.3 and runs with it automatically.

                                            Thursday, May 9, 2024 (10:21 AM)
    *   Simple task: reverse and print a list of songs.
        -   scratch.py
            >   This works:
                    songs.reverse()
                    print(*songs, sep='\n')
                So does
                    print('\n'.join(songs))
        -   Can I get it to read from a file?
            It works!
            >   How can I make this callable from command prompt
                :   Take clues from
                        S:\will\documents\OneDrive\2018\fitfiles
                            \fitfileanalyses.bat
                    The command line is
                        c:\python27\python %base%\fitfileanalyses.py %1
                    where %base% is the folder containing fitfileanalyses.py
                    and %1 is the data file. So the command should look
                    something like
                        <path>python <path>reverse_song_list.py songlist.txt
                :   Get more clues from
                        S:\will\documents\OneDrive\2018\fitfiles
                            \fitfileanalyses.py
                    about getting command-line arguments.
                    And more from
                        https://www.tutorialspoint.com/python
                            /python_command_line_arguments.htm
                :   Problem: the 'python' command points to v2.7.
                    But I don't want to change this.
                    This works:
                        ...>py reverse_songlist.py songlist.txt
                    because 'py' brings v3.6.
                        https://docs.python.org/3/using
                            /windows.html#configuring-python
                    Why doesn't 3.12 come up?
                    Can't I just create a windows command (like python312)
                    that refers to the one I want?
                        https://stackoverflow.com/questions/5181709
                            /custom-commands-in-windows-command-prompt
                    suggest a batch file is the best option. Try it.
                    Got this working:
                        S:\...\gigtools>reverse_songlist songlist.txt
                    which calls reverse_songlist.py on the file songlist.txt.
                :   Make an EditPlus tool I can call from the song-list file:
                        reverse_songlist_editplus_a.png
                    it works!!! It even captures the output in the output
                    window so I don't need to hold a command window open.

                                                Friday, May 10, 2024 (9:27 AM)
    *   Time to get this project under version control with GIT. Follow
                S:\will\documents\OneDrive\2018\fitfiles\data
                    \analysis_notes.txt
        for techniques.
        -   Right-click in the main folder and select "about". Update
            TortoiseGit from 2.7.0.0 to 2.16.0.0.
            >   It has trouble shutting down other applications then complains
                about some .cab file being corrupt. Reboot. TortoiseGit
                is gone from the context menu. Go to
                    https://tortoisegit.org/
                    TortoiseGit-2.16.0.0-64bit.msi
            >   Do I need to update Git? Will it tell me?
                Yes, my version is old and unsupported. It prompts me to
                open the git website.
                    https://gitforwindows.org/
                    Git-2.45.0-64-bit.exe
                Cancel the TortoiseGit installation and install Git 2.45.
                Use defaults.
                    Removing Git 2.22
                Odd, I thought 2.22 was what TortoiseGit wanted.
            >   Install TortoiseGit 2.16.0
                It asks if I want to modify, repair, or remove. Try repair.
                It appears to work now.
        -   Right-click in the main folder and select "create GIT repository
            here."
        -   Create the new repository on GitHub. No license, public, no readme,
            no .gitignore
                The site is at
                    https://github.com/guitarsenall/GigTools
                The repository URL is
                    https://github.com/guitarsenall/GigTools.git
        -   Link the two together.
            >   I will need README.md. Clone one from
                    S:\will\documents\OneDrive\2018\notesparser
                        \notesparser\README.md
            >   Add the files I have, including README.md.
            >   commit.
            >   At this point, I can probably do a push. Try it.
                Select manage under remote. Enter the URL in the field.
                    tortoise_git_push_a.png
                This is a little different. With FitFiles, I used the
                Arbitrary URL field, but remote seems more appropriate.
                    Authentication failed
                I think Git forgot about my password. Settings dialog.
                Can't find where to enter it. Google. Nothing.
                Try push again. It prompted me for username and password
                but failed again.
                Try push again. It launched a dialog that let me authenticate
                through the browser, and IT WORKED!! And the files are on
                GitHub.
                Weird.

    *   Another simple task: compare strings for partial match.
        OneNote OCR often misspells song titles that I have to fix manually.
        If I have a reference of correct titles, perhaps I can detect which
        song a misspelling refers to, correct it, and detect the match.
        -   A basis for detecting a partial match:
                https://note.nkmk.me/en/python-str-compare/
        -   Define the correct titles.
            >   Let's start by doing this right: Export The Repertwaar to
                        music_performance_repertoire.csv
                :   I will need to strip the '*' for instrumental titles.
                    Or leave it in since I only need a partial match?
                :   How do I read a CSV file in python?
                    Python comes with a CSV library:
                        https://docs.python.org/3/library/csv.html
                    May as well start there.
                    A tutorial is at
                        https://www.analyticsvidhya.com/blog/2021/08
                            /python-tutorial-working-with-csv-file
                            -for-data-science/
                :   Error: some fields have quotes that give it problems.
                    Found this:
                        https://stackoverflow.com/questions/21527057
                            /python-parse-csv-ignoring-comma-with-double-quotes
                    which uses,
                        csv.reader(lines, quotechar='"', delimiter=',',
                            quoting=csv.QUOTE_ALL, skipinitialspace=True):
                    No luck.
                    Copy to junk.csv and remove most lines. It works. I don't
                    know which line is giving it trouble. Continue for now.
                :   I really want to use csv.DictReader().
                :   If I want to read in energy as a numeric, I might
                    have to switch the Pandas method.
                    But I don't have Pandas. Better get it.
                        https://pandas.pydata.org/docs/getting_started
                            /install.html
                    But this says,
                        For users that are new to Python, the easiest way to
                        install Python, pandas, and the packages that make up
                        the PyData stack (SciPy, NumPy, Matplotlib, and more) is
                        with Anaconda, a cross-platform (Linux, macOS, Windows)
                        Python distribution for data analytics and scientific
                        computing. Installation instructions for Anaconda can be
                        found here.
                    It looks like getting Pandas is going to complicated and
                    require decisions. Perhaps, for now, I should convert the
                    energy string to a float:
                        >>> float(row['energy'])
                            1.0
                :   The offending title is
                        Del’s Bells
                    The apostrophe is a special character. Replace them in
                    music_performance_repertoire files with the single
                    quote, "'".
                :   I now have a list of dictionaries:
                        >>> len(songs)
                        83
                        >>> songs[79]['title']
                        'The Power Of Love'
                        >>> songs[79]['energy']
                        8.0
                        >>> songs[79]['data']
                        {'artist': 'Huey Lewis',
                         'energy': '8',
                         'genre': 'classic hits',
                         'guitar': '618e',
                         'song': 'The Power Of Love',
                         'technique': 'strum',
                         'type': 'loop w FX',
                         'unplugged': 'yes'}
        -   Now I can import songlist.txt, which contains some misspelled
            titles, and get the corresponding songs.
            >   Start with one: 'Addisonls Walk'
            >   Expand. scratch.py now has a snippet that reads in the
                repertwaar as well as songlist.txt, loops through songlist,
                matches with titles in repertwaar, and prints the best score
                and the next-best score:
                    partial_match_title_a.png
                All matching scores are 70%, and all next-best scores are
                zero.  But does zero make sense? I am only testing for the
                occurrence of two characters.
                    >>> match_score('Time After Time', 'Time In A Bottle')
                        35.714285714285715
                Some nonzero LastScore values should occur.
                Oops, found the bug. Try again:
                    partial_match_title_b.png
                The best false match is 57.1% (for The Wind & The Wheat),
                and the worst true match is 78.6% for Addison's Walk.
                But is it really right? I had better capture the false-match
                song.
                    partial_match_title_c.png
                OK, now I can see that all of the matches are correct even
                though some false matches score pretty high.
                Is that important? I can cut the search off if I find a
                score exceeding a threshold of, say, 70%. Or I can let it find
                the best. The number of iterations is the number of songs
                played in a gig times the number in the repertoire.
                I don't see this exceeding about 50*100 = 5,000. No big deal.
                Find the best.
            >   Commit & push

                                            Tuesday, May 14, 2024 (10:42 AM)
    *   Back to reverse_songlist.py: Get it to use the Repertwaar for
        correct spellings.
        -   Prototype in scratch.py.
        -   Port code to reverse_songlist.py
            IT WORKS!!
        -   Commit & push

    *   Another easy tool: Reorder the Repertwaar based on last gig:
        move songs from last gig (songlist.txt) to bottom of the Repertwaar to
        create a prioritized list that deprioritizes most recently played at a
        given venue.
        -   I actually used a Lambda function!!
            The Repertwaar is a list with the sort() method that accepts
            a sorting key.
            sort the Repertwaar by title:
                repertwaar.sort( key = lambda s: s['title'] )
            where s is a song within repertwaar. But it is a dictionary,
            so extract the title to use as a sorting key.
            This approach could be used to sort the Repertwaar
            on ANY field:
                repertwaar.sort( key = lambda s: s['energy'] )
            or,
                repertwaar.sort( key = lambda s: s['data']['genre'] )

    *   Calculate the Gig Energy Index as the RMS of the song energies.
        -   It works.
        -   Add it to reverse_songlist.py to get it for every future
            gig.
            >   Some notable gig energies:
                    Sullivan's 2/9/24               6.2
                    Sullivan's 3/29/24              7.3     Definite increase!
                    Innkeepers 5/11/24              5.8
                    Blue Margaritas 5/5/24          5.4
                    Germantown Spring Fling 5/4/24  5.3
                    Orange Cup 4/21/24              5.5
                    Café Santa Rosa 4/12/24         4.3
                    Opie’s 4/6/24                   6.2
                    Hidden Hills 3/30/24            5.5
                    Market Alley Wines 3/23/24      5.8
        -   Commit & push

                                            Wednesday, May 15, 2024 (1:48 PM)
    *   Back to reordering the Repertwaar. I am going to be using this
        regularly, so make it its own script, reorder_repertoire.py.
        -   It works great! I created a reordered repertwaar for Michael's
            Friday night.
        -   Commit & push


                                            Thursday, May 16, 2024 (12:02 PM)
+   Read OneNote data with Python.

    *   Study
        -   https://stackoverflow.com/questions/34622471
                /how-to-access-download-onenote-notebook-with-python
            This is old and has dead links.
        -   https://www.quora.com/Can-you-read-OneNote-data-with-Python
            This is worth studying.
            >   It contains a link:
                    https://learn.microsoft.com/en-us/graph
                        /integrate-with-onenote
                But it feels overwhelming with lots of dead ends.
                And it does not discuss Python.
        -   https://www.codeproject.com/Articles/5318953
                /OneNote-to-Markdown-Using-Python-and-the-Microsoft
            This might have code examples, but I will have to dig deep.
        -   This one costs money
                https://www.cdata.com/kb/tech/onenote-python-petl.rst
            and I can't really tell if or how it will get me there.
        -   This one
                https://github.com/DissectMalware/pyOneNote
            says it just dumps everything into a directory. But in what
            format?
        -   This one
                https://github.com/varunsrin/one-py
            says,
                "OneNote is an object model class that lets you read content and
                hierarchy from the OneNote application. It exposes them as
                native python types so you can read OneNote data without having
                to muck around with the underlying COM interfaces"
            but it is written for
                Windows 7 with Python 3.x
                OneNote 2013 or 2010 with your notebooks open
            and likely to not work.
        -   This one
                https://www.cdata.com/kb/tech/onenote-python-pandas.rst
            claims to make it simple, but the example code has huge strings
            with no clue as to how to build them. It says,
                "OneNote uses the OAuth authentication standard. To authenticate
                using OAuth, you will need to create an app to obtain the
                OAuthClientId, OAuthClientSecret, and CallbackURL connection
                properties. See the Help documentation for more information."
            What help documentation? OneNote??
        -   I fear this is simply out of scope.

                                                Friday, May 17, 2024 (10:04 AM)
    *   Can I export the pages to text files and read them?
        -   File:export does not offer text. If offers
                    .one
                    .docx
                    .doc
                    .pdf
                    .xps
                    .mht (web page)
            >   Try some on page "Tres Rojas 9/10/23"
                It has several images which increase file size.
                :   Create a subfolder, 'gigfiles'.
                :   .mht (web page)
                    The page gets saved as
                    "Tres Rojas 91023.mht". It is huge (8MB) and binary.
                :   .xps: "Tres Rojas 91023.xps". 1.5MB. Also binary.
                :   .doc: 'Tres Rojas 91023.doc'. 6MB. Big.
                    It has a binary header, but the text body is readily
                    available. Perhaps I could find a way to skip the header?
                :   .docx: 'Tres Rojas 91023.docx'. 4MB. Binary.
                    #   This might help:
                        Google('convert word doc to text python')
                            https://stackoverflow.com/questions/62859658
                                /how-to-convert-docx-to-txt-in-python
                            https://stackoverflow.com/questions/42482
                                /best-way-to-extract-text-from-a-word-doc
                                -without-using-com-automation
                :   .pdf: 'Tres Rojas 91023.pdf'. 1MB. Smallest file. Binary.
                    #   This might help:
                            https://www.geeksforgeeks.org
                                /extract-text-from-pdf-file-using-python/
                        The process looks easy. I like this one.
        -   Read 'Tres Rojas 91023.pdf' using pypdf from
                    https://www.geeksforgeeks.org
                        /extract-text-from-pdf-file-using-python/
            >   How to install?
                :   It says to use
                        pip install pypdf
                    in terminal. Hmmm. Point the terminal at the Python 3.12
                    folder,
                        C:\Users\Owner\AppData\Local\Programs\Python\Python312\
                    Error:
                        'pip' is not recognized as an internal or external
                        command, operable program or batch file.
                    Found this:
                        https://stackoverflow.com/questions/23708898
                            /pip-is-not-recognized-as-an-internal-or-external
                            -command
                    which says,
                        For Windows, when you install a package, you type:
                        python -m pip install [packagename]
                    IT WORKED!
                        install_pypdf_a.png
                    Of course, the terminal is in the python folder
                    so the correct python version gets called.
            >   Try it in scratch.py
                :   It works, but it discards line returns, which are
                    needed to isolate blocks so that I can find the
                    list of songs. It also inserts extra stuff at the
                    bottom of the page:
                        'Brandy \n'
                        'Those Who Wait \n'
                        'The Wind & The Wheat Tres Rojas 9/10/23\n'
                        'Sunday, September 10, 2023 5:19 PM\n'
                        '   Performances Page 1    ')
            >   Probably not the best solution. The next best might be to
                read the current format of Word, which may come in handy
                later.
        -   Read 'Tres Rojas 91023.docx'.
            >   Research best approach. Most point to python-docx:
                    https://python-docx.readthedocs.io/en/latest/
                See sample code in
                    https://stackoverflow.com/questions/29309085
                        /read-docx-files-via-python
            >   Install via terminal in python312 folder with,
                    python -m pip install python-docx
                Try
                    >>> import docx
                Success. Try
                    >>> doc = docx.Document(
            >   Try it out.
                Error:
                    docx.opc.exceptions.PackageNotFoundError:
                    Package not found at 'Tres Rojas 91023.docx'
                google(python-docx PackageNotFoundError)
                    This error simply means there is no .docx file at the
                    location you specified.
                Now it works quite nicely, but line returns are '\xa0'.
                Nop, not all of them:
                    'Lisa said she would reach out in January or February ...'
                    'next year. ',                                        ...
                    'Calendar reminder for 1/8/24.',                      ...
                    ' ',                                                  ...
                    '2/1/23 Messenger with Lisa. ',                       ...
                    'Play 1-4PM. ',                                       ...
                    '3 * $75 = $225',                                     ...
                    ' ',                                                  ...
                    '6/8/23 Running into his system: Send him the quarter-...
                    'volume knob assigned to it. Use XLR output to Bose, a...
                    'the Bose or using the Global EQ level. ',
                    '8/28/23 Create event so I can invite people.',
                    '9/2/23 Boost event, $10',
                    '\xa0',
                    '\xa0',
                    'The Mission ',
                    'As Warm As Tears ',
                    'Morning Snow ',
                    'Metamorphosis ',
                    'If You Could Read My Mind ',
                    'In Your Peace / I Love You Lord ',
                Some discussion of cleaning it up at
                    https://stackoverflow.com/questions/10993612
                        /how-to-remove-xa0-from-string-in-python
                Use
                    import unicodedata
                    unicodedata.normalize('NFKD',docpara.text)
                It works.
            >   Can I isolate blocks of text? allText is a list of strings
                where each element is a line. Blocks are separated
                by a line containing ' '.
                It works great. One of the blocks is now the song list.
            >   Can I detect a song list?
                :   I am going to have to encapsulate some of these
                    functions that I am using in multiple places:
                        reading the repertoire
                        finding matches in a song list
                        scoring the match between two strings
                                            Saturday, May 18, 2024 (2:07 PM)
                    Place functions in gigtools.py.
                    Got it working.
                    Commit & push
                :   What would be the criteria?
                        1. A block should have more than 5 lines.
                        2. A block should contain more than 50% matches.
                :   Got it working!
                    I now have a list of strings from the file,
                    but they have not been turned into songs from repertwaar.
                    Commit & push
                                            Wednesday, May 22, 2024 (4:45 PM)
            >   Create gigtools.match_gig_songs() to turn the list of strings
                from the file into a list of songs from the Repertwaar.
                Clone gigtools.read_gig_songs().
                :   It works. I now have a list of gig_songs, each of which can
                    be tested against repertwaar elements:
                        >>> gig_songs[26] is repertwaar[0]
                        True
                        >>> gig_songs[26] == repertwaar[0]
                        True
                    So I can add a field for the play count and increment it:
                        for song in gig_songs:
                            gig_songs['playcount']  += 1
                :   Commit/push
        -   Read more than one performance.
            >   How do I export more than one from OneNote?
                :   Select multiple pages. OneNote allows me to select
                    "selected pages" for export but prompts me for one name
                    and write one document. Then it write one big document
                    with the performances in sequence. 14MB for the
                    8 gigs in may. I do NOT want to parse all THAT! I might have
                    to export one performance at a time. But that would be
                    really painful also. Perhaps I should look at parsing
                    the multidoc, multi.docx.
                                            Thursday, May 23, 2024 (10:14 AM)
            >   Try reading multi.docx in scratch.py.
                :   Separate the gigs. Each begins with a title followed
                    by some header information:
                        'Tres Rojas 5/19/24',
                        'Friday, May 17, 2024',
                        '8:47 AM',
                        ' ',
                        ' ',
                        'Performance #3',
                        'Shift: 1-4PM',
                        'Pay: $225',
                        'Cash Tips: $15',
                        'Digital Tips: $20',
                        'Mileage: 20.0',
                        'Loadout: Wide Outdoor',
                        'Guitars: 814ce, 618e, V700',
                        'Songs: 38',
                        'Energy: 5.9',
                        'Special Notes:',
                    I think the most reliable detection is 'Performance #',
                    which follows the title by 3-5 lines. So perhaps I
                    find multiple occurrences of this and look backward
                    to get the title line, which should end with '/24'
                    #   Got it working: title_idx is a list of indices
                        into allText for the title lines.
                :   Try parsing to read a list of gigs. Working.
                :   I want a formatted print. Study
                        https://docs.python.org/3/library/string.html
                    So, to print the repertwaar with play count, use,
                        for song in repertwaar:
                            print( '{0:<40}: {1:d} plays'.format(
                                        song['title'].removesuffix('*'),
                                        song['playcount'] ) )
                :   IT WORKS!!! See output.txt.
                :   Commit/push
            >   Can I extract the venue and date from the title?
                :   Yes:
                        import datetime as dt
                        title   = 'Germantown Spring Fling 5/4/24'
                        tok     = title.rpartition(' ')
                        venue   = tok[0]
                        datestr = tok[2]
                        m,d,y   = datestr.split('/')
                        date    = dt.date( int(y)+2000, int(m), int(d) )
                :   Then I can add a list of dates to the song dictionary.
            >   New idea: export a range of performances per month into separate
                files. multi.docx has the current list of gigs in May, 2024.
                Add January, February, March, and April:
                    gigs_january_2024.docx
                    gigs_february_2024.docx
                    gigs_march_2024.docx
                    gigs_april_2024.docx
                :   IT WORKS!!! See output.txt.
                :   Commit/push
                                                Friday, May 31, 2024 (12:09 PM)
        -   Add some information about when the song was played.
            >   Export May performances to gigs_may_2024.docx.
            >   Format: print a sequence of numbers where each is the
                number of days between the play dates, e.g.,
                    Kashmir     : 8 plays : 12,1,8,5,29,8,49,22
                The first interval measures today to the most recent play.
            >   Got it working.
                -   Commit/push

                                                Tuesday, June 4, 2024 (11:36 AM)
    *   Read rehearsals.txt to add play counts to songs and improve freshness.
        -   Can't use ConfigParser because rehearsals.txt will include
            multiple rehearsals.
        -   The code in scratch.py is too big now. Move it to
            play_count.py.
            >   Should I do any refactoring?
                One section of code reads the .docx files and modifies
                the repertwaar; the next displays it. So the first could be
                a function,
                    read_gig_files(gig_files, repertwaar)
                moved to gigtools.py
            >   Got it working.
                -   Commit/push
        -   Create a snippet to read rehearsals.txt.
            >   I think it is working. No printout, just adding playdates
                to the songs found.
                -   Commit/push
        -   Integrate it with the .docx read. Move it all to
            play_count.py.
            >   Got it working. See output.txt.
                -   Commit/push


                                            Thursday, June 6, 2024 (1:22 PM)
+   Venue history: Print the Repertwaar with a suffix that indicates the
    play history at a given venue.

    *   Detect venues.
        -   How can I do this without predefining the venues? gigs is a list
            of dictionaries.
            >   Use a while loop to iterate over the gigs, use gigs.pop()
                to get a gig and remove it from the list. Iterate until the
                list is empty.
                #   Try this with integers.
                    Not trivial since gigs has to be popped every time
                    a match is found.
                    Tricky (double while loop) but got it working.
                #   Expand to gigs. Now I need a way to detect a match
                    of the venue name.
                #   Oops, the algorithm gets a max of 2 occurrences.
                    Back to integers.
                    Still stumped. See output.txt. The first break
                    statement seems to be breaking both loops.
                                                Friday, June 7, 2024 (3:48 PM)
                    Commit before I really change the algorithm.
                    Very simple version works:
                        # just find a 4
                        v   = []
                        c   = 0
                        searching = True
                        while searching:
                            print(f'g = {g}')
                            for i in range(len(g)):
                                if g[i]==4:
                                    print(f'\tfound one')
                                    v.append( g.pop(i) )
                                    break
                            if len(g)==0 or len(g)<c:
                                searching   = False
                            c   += 1
                    Adapt for other numbers. Got it working:
                        g = [0, 4, 1, 5, 2, 4, 3, 4, 5, 2, 6, 4, 7, 2, 8]
                        >>> v
                        {0: [0],
                         1: [1],
                         2: [2, 2, 2],
                         3: [3],
                         4: [4, 4, 4, 4],
                         5: [5, 5],
                         6: [6],
                         7: [7],
                         8: [8]}
                        Commit.
                #   Adapt the algorithm to the gigs.
                    IT WORKS!!! See output.txt

                                            Thursday, June 13, 2024 (10:27 AM)
    *   Mark repertwaar to indicate recent plays.
        -   Idea: A series of digits in parentheses, for example:
                    Behind Blue Eyes (1347)
            where each digit represents how many gigs ago at THAT venue
            I played that song. In this case, 1347 means I played it
                Last gig        : yes
                2 gigs ago      : no
                3 gigs ago      : yes
                4 gigs ago      : yes
                5 gigs ago      : no
                6 gigs ago      : no
                7 gigs ago      : yes
            Don't bother going past 9.
            This way I get a quick indication of how much I have played that
            song recently at my repeat venues.
        -   Move code to gigtools.gigs_by_venue()
        -   Prototype one song:
                VenueName   = 'Holly Brook Washington'
                SongName    = 'Brandy'
            It works!
                >>> TitleString
                'Holly Brook Washington (13)'
            Commit.
            Oops, print song title, not venue name.
        -   Expand to all songs.
            >   It works for well-named venues. But it is having trouble
                with "Michael’S". The apostrophe is not an alphanumeric
                character. I need to get rid of these in venue and song names!
                Google. Found this:
                    >>> k[12]
                    'Michael’S'
                    >>> print( ''.join(ch for ch in k[12] if ch.isalnum()) )
                    MichaelS
                Implement in gt.fix_venue_name().
                Oops. It is removing spaces. Use ch.isascii()
            >   Got it working in scratch.py for
                    VenueName   = "Michaels"
                Sample:
                    Crazy Little Thing Called Love (1)
                    Del's Bells (134)
                    Doctor My Eyes (2345)
                    Eight Days A Week (1235)
                    Emmaus (13)
                    Even The Losers (2)
                    Everybody Wants to Rule the World (145)
                    Everything I Own (234)
                    Fare Thee Well (2)
                See the rest in output.txt
            >   Commit/push

    *   track guitars used in gigs.
        -   See output.txt. It shows I have played the 814ce in 13 gigs.
            Before that I was playing the 812ce. So it is time to rotate
            to the 414ce-L3.
            >   Commit/push

                                            Tuesday, June 18, 2024 (10:20 AM)
    *   Having trouble with marking the repertwaar:
        -   Songs are not getting matched in reverse_songlist.py:
                Unmatched line: Cheering You On
                Unmatched line: Eight Days A Week
                Unmatched line: Searchinl So Long
                Unmatched line: Came The Light
                Unmatched line: Fare T hee Well
                Unmatched line: I've Just Seen A Face
                Unmatched line: Hide Your Love Away
                Unmatched line: Solitary Man
                Unmatched line: There She Goes
                Unmatched line: Mood For A Day
                Unmatched line: The Treasure
                Unmatched line: Those Who Wait
                Unmatched line: As Warm As Tears
                Unmatched line: Morning Snow
            These are the ones WITHOUT markings, so my modifications to
            gigtools.match_score() must have broken it somehow.
            Got it fixed.
            Process songs from Innkeepers the other night.
        -   Move code from scratch.py to
                gigtools.venue_play_list(VenueName, gigs, repertwaar)
        -   Create a venue play-list for today at Holly Brook East Peoria.
            >   It works. See output.txt.
                    venue_play_list_a.png
            >   Commit/push


                                            Friday, June 21, 2024 (10:41 AM)
+   Gig energy report

    *   Initial ideas:
        -   Print all gigs with their energies
            >   Include a deviation?
        -   Function that accepts a gig prints the songs in order with
            their energies.
            >   If Verbose==True...
            >   Plot?

    *   Print all gigs with their energies
        -   Ask ChatGPT:
                In python 3.12, I am entering the following:
                print(f"{0:3.1f} and {1:3d}".format(3.1459, 2))
                Why won't the first number print "3.1"?
            It fully explains the answer: don't use the format() method
            with an F-string. That is, get rid of the 'f':
                print("{0:3.1f} and {1:3d}".format(3.1459, 2))
            Scary.
        -   Function that accepts a gig prints the songs in order with
            their energies.
            >   If Verbose==True...
        -   It works. See output.txt.
            And I was right: yesterday's gig was a record low at 2.9.
        -   Commit/push


                                            Friday, June 28, 2024 (11:07 AM)
+   Guitar report
    *   Initial thoughts
        -   How many gigs since last string change?  I think I want a running
            history that shows a guitar's gigs, string changes, and string
            breakage.
        -   How many songs?

    *   Begin with the date of the most recent string change.
        -   Put data in guitars.txt. Read the data into guitars, a list of
            dictionaries.
            >   Initial idea: each guitar has a 'type': strum, gentle, or
                variax. The 814ce, 414ce-L3, and 812ce are all 'gentle'.
                This way, knowing which gentle guitar I brought and what
                type the song calls for, I can know which guitar was used
                for each song.
            >   It works.
                Commit/push.
        -   Try looping over each guitar, using the date of its string change
            in code similar to what is already there.
            >   It works. And it shows the V700 has had FORTY-THREE gigs
                since its last string change on 12/14/23. And that is why
                I need to track the number of songs, which I think will
                correlate better.
            >   Commit/push.

    *   Count the songs.
        -   Requires a change to music_performance_repertoire.xlsx and its
            CSV file: change guitar names to the types: strum, gentle, or
            variax.
            >   Am I reading the guitar type into the song? Fixed.
        -   How do I access the song's guitar type in the gig?
                gig[songs][i]['data']['guitar']
            That is a long address!
        -   Got it working.
        -   Try the using old string change date for the 618e:
                    True    = 6/25/24
                    Old     = 5/29/24
                618e    : 12 gigs, 107 songs =  8.9 songs/gig
                414ce-L3:  5 gigs,  67 songs = 13.4 songs/gig
                V700    : 43 gigs, 195 songs =  4.5 songs/gig
            The 618e was at its limit and broke the high-E string during
            the 11th gig. I don't know how the V700 has held up this long.
            But it looks like a limit of 100 songs is prudent.
            >   Commit/push.


                                                Monday, July 1, 2024 (9:06 AM)
+   Song Freshness
    *   Process songs: Use the gigdate to compute the number days
        since it was played, and use this to concoct a 'freshness' score
        that can be used to prioritize rehearsal time.
        -   Initial thoughts
            Let's say a song needs to be played every 14 days to stay fresh.
            If this happens, its freshness is 100%. If I fail to play today, the
            freshness is somehow decreased, but not by much.  And recent plays
            are much more important than plays a year ago. So I envision a
            first-order exponential decay. Expand that to a transfer function
            similar to that used for Cycling Chronic Training Load.
            >   Ask ChatGPT for the formula:
                    cycling_training_load_a.png
            >   This formula needs the difficulty of the song: some songs
                need to be played every 2 weeks (e.g., "Still The One" and
                "Kashmir") while others could go 2 months (e.g., "Wild World").
                But I think that would be the time constant. Harder songs lose
                their freshness faster.
            >   Ask ChatGPT to convert the expression to a Laplace-domain
                transfer function:
                                  1
                    H(S)    = ---------
                              tau*S + 1
                then convert this to a differential equation:
                    dF/dT = ( P(t) - F(t) ) / tau
                Experiment with this in junk.xlxs, but  scale units of F by
                tau (play interval).
                    dF/dT[n]    = ( P(n)       - F(n-1)/tau ) / tau
                    F[n]        = ( F[n-1]/tau + dF/dT[n]   ) * tau
                This makes the value of freshness unity regardless of
                the play interval, tau. Then scale the final result by 100%.
                I like the result.

    *   Prototype in play_count.py
        -   I will need to add the play interval to the repertwaar spreadsheet,
            music_performance_repertoire.xlsx and its CSV file.
            Add a column, "mastery", to indicate it.
        -   Got it working for Kashmir.
                song_freshness_a.png
        -   Expand for all songs and print.
            Print the mastery also.
            Some Output:
                Kashmir                  (15,  15%): 43,1,8,5,29,8,49,22
                Two Of Us                (20,  18%): 51,20,2,9,4,1,3,4,14,1
                Cheering You On          (15,  53%): 16,14,8
                Leading You Home         (40,  77%): 10
                Still The One            (15,  93%): 16,3,1,23,14,16,14,6,1,...
                It Don't Come Easy       (20,  97%): 23,7,6,9,6,1,19,15,8,14,56
                Heart of Worship         (60, 103%): 51,8,27
                What I Like About You    (15, 105%): 10,6,14,6,35,23,34,13,23
                Love The One You're With (20, 113%): 19,6,11,7,9,6,9,6,14,7,...
                Give A Little Bit        (40, 138%): 16,28,1,83,15
                Came The Light           (30, 138%): 16,16,6,33,2,44
                Listen to the Music      (20, 139%): 16,7,9,4,8,1,7,34,8,34,...
                Beyond Justice to Mercy  (30, 140%): 20,18,7,6,8,31,10,28
                When Night Falls         (30, 140%): 10,17,11,98,2
                There She Goes           (30, 159%): 16,7,21,1,41,8,44,13,13
                When My Love Awakened    (50, 165%): 16,27,8,42
            The full output is in output.txt.
            Some things to notice:
            >   Kashmir tops the list because of its high mastery requirement
                and having not been played in 43 days, even though it had
                a string of plays. Notice its final result agrees with that in
                    song_freshness_a.png
            >   Leading You Home has low mastery requirement but has only
                been played once, though recently.
            >   Heart of Worship has minimal mastery but very low plays
                and a long first interval.
            >   Beyond Justice to Mercy is high on the list, which correlates
                with the recent trouble I had with the song.
            >   I like it.
                commit/push




================================================================================

+   TO DO:
    *   Mileage report
        -   Write to CSV
    *   Gig Energy Report
        -   Print all gigs with their energies
            >   Include a deviation?
    *   Detecting the song list should not require a certain number of
        songs. Find the block with the most matches.
        gigtools.read_gig_files()
        -   The section '# get the song list' should be a function.
    *   Song database
        -   in SQL?
            >   Microsoft has a free SQL
                    https://www.microsoft.com/en-us
                        /sql-server/sql-server-downloads
        -   track plays
        -   Match titles


