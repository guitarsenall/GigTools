S:\will\documents\OneDrive\2024\gigtools\data\gigtools_notes.txt

                                                Tuesday, May 7, 2024 (11:58 AM)
OBJECTIVES:
    Refresh Python skills by creating some tools to help process my
    gig data.
        * Bigger goals:
            Prioritize songs for rehearsals
            Prioritize songs for repeat gigs
                (e.g., don't play what I played last month)
            Notify me when a guitar needs new strings
        * Baby steps:
            Script to reverse the song list since it comes
                backwards from OneNote
            Match mis-spelled song titles
                Idea: matching 2-character sequences exceeding
                a percentage threshold.
            Get gig data from Outlook and/or OneNote

+   Get python working again.

    *   Update PyScripter
        -   The update  REQUIRES that I install Python 3.7 or above.
            It is also 32-bit. After some researching, I think I want
            to go with 64-bit (default download).
        -   Download 64-bit PyScripter
                https://sourceforge.net/projects/pyscripter/
                PyScripter-4.3.4-x64-Setup.exe
            Don't install yet. First install Python.
        -   Download latest 64-bit version of Python from
                https://www.python.org/downloads/
                python-3.12.3-amd64.exe
            Install. Default.
            Verify at command prompt:
                >py
            Gives:
                Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45)
                [MSC v.1900 32 bit (Intel)] on win32
            That is an old version installed before.
            Where is it installed? Google. Here:
                C:\Users\Owner\AppData\Local\Programs\Python\Python312\
            Verify in command window:
                C:\Users\Owner>cd C:\Users\Owner\AppData\Local\Programs
                        \Python\Python312
                C:\Users\Owner\AppData\Local\Programs\Python\Python312>python
                Python 3.12.3 (tags/v3.12.3:f6650f9, Apr  9 2024, 14:05:25)
                    [MSC v.1938 64 bit (AMD64)] on win32
                Type "help", "copyright", "credits" or "license" for more
                    information.
            Looks good.
        -   Now install
                PyScripter-4.3.4-x64-Setup.exe
            It found Python 3.12.3 and runs with it automatically.

                                            Thursday, May 9, 2024 (10:21 AM)
    *   Simple task: reverse and print a list of songs.
        -   scratch.py
            >   This works:
                    songs.reverse()
                    print(*songs, sep='\n')
                So does
                    print('\n'.join(songs))
        -   Can I get it to read from a file?
            It works!
            >   How can I make this callable from command prompt
                :   Take clues from
                        S:\will\documents\OneDrive\2018\fitfiles
                            \fitfileanalyses.bat
                    The command line is
                        c:\python27\python %base%\fitfileanalyses.py %1
                    where %base% is the folder containing fitfileanalyses.py
                    and %1 is the data file. So the command should look
                    something like
                        <path>python <path>reverse_song_list.py songlist.txt
                :   Get more clues from
                        S:\will\documents\OneDrive\2018\fitfiles
                            \fitfileanalyses.py
                    about getting command-line arguments.
                    And more from
                        https://www.tutorialspoint.com/python
                            /python_command_line_arguments.htm
                :   Problem: the 'python' command points to v2.7.
                    But I don't want to change this.
                    This works:
                        ...>py reverse_songlist.py songlist.txt
                    because 'py' brings v3.6.
                        https://docs.python.org/3/using
                            /windows.html#configuring-python
                    Why doesn't 3.12 come up?
                    Can't I just create a windows command (like python312)
                    that refers to the one I want?
                        https://stackoverflow.com/questions/5181709
                            /custom-commands-in-windows-command-prompt
                    suggest a batch file is the best option. Try it.
                    Got this working:
                        S:\...\gigtools>reverse_songlist songlist.txt
                    which calls reverse_songlist.py on the file songlist.txt.
                :   Make an EditPlus tool I can call from the song-list file:
                        reverse_songlist_editplus_a.png
                    it works!!! It even captures the output in the output
                    window so I don't need to hold a command window open.

                                                Friday, May 10, 2024 (9:27 AM)
    *   Time to get this project under version control with GIT. Follow
                S:\will\documents\OneDrive\2018\fitfiles\data
                    \analysis_notes.txt
        for techniques.
        -   Right-click in the main folder and select "about". Update
            TortoiseGit from 2.7.0.0 to 2.16.0.0.
            >   It has trouble shutting down other applications then complains
                about some .cab file being corrupt. Reboot. TortoiseGit
                is gone from the context menu. Go to
                    https://tortoisegit.org/
                    TortoiseGit-2.16.0.0-64bit.msi
            >   Do I need to update Git? Will it tell me?
                Yes, my version is old and unsupported. It prompts me to
                open the git website.
                    https://gitforwindows.org/
                    Git-2.45.0-64-bit.exe
                Cancel the TortoiseGit installation and install Git 2.45.
                Use defaults.
                    Removing Git 2.22
                Odd, I thought 2.22 was what TortoiseGit wanted.
            >   Install TortoiseGit 2.16.0
                It asks if I want to modify, repair, or remove. Try repair.
                It appears to work now.
        -   Right-click in the main folder and select "create GIT repository
            here."
        -   Create the new repository on GitHub. No license, public, no readme,
            no .gitignore
                The site is at
                    https://github.com/guitarsenall/GigTools
                The repository URL is
                    https://github.com/guitarsenall/GigTools.git
        -   Link the two together.
            >   I will need README.md. Clone one from
                    S:\will\documents\OneDrive\2018\notesparser
                        \notesparser\README.md
            >   Add the files I have, including README.md.
            >   commit.
            >   At this point, I can probably do a push. Try it.
                Select manage under remote. Enter the URL in the field.
                    tortoise_git_push_a.png
                This is a little different. With FitFiles, I used the
                Arbitrary URL field, but remote seems more appropriate.
                    Authentication failed
                I think Git forgot about my password. Settings dialog.
                Can't find where to enter it. Google. Nothing.
                Try push again. It prompted me for username and password
                but failed again.
                Try push again. It launched a dialog that let me authenticate
                through the browser, and IT WORKED!! And the files are on
                GitHub.
                Weird.

    *   Another simple task: compare strings for partial match.
        OneNote OCR often misspells song titles that I have to fix manually.
        If I have a reference of correct titles, perhaps I can detect which
        song a misspelling refers to, correct it, and detect the match.
        -   A basis for detecting a partial match:
                https://note.nkmk.me/en/python-str-compare/
        -   Define the correct titles.
            >   Let's start by doing this right: Export The Repertwaar to
                        music_performance_repertoire.csv
                :   I will need to strip the '*' for instrumental titles.
                    Or leave it in since I only need a partial match?
                :   How do I read a CSV file in python?
                    Python comes with a CSV library:
                        https://docs.python.org/3/library/csv.html
                    May as well start there.
                    A tutorial is at
                        https://www.analyticsvidhya.com/blog/2021/08
                            /python-tutorial-working-with-csv-file
                            -for-data-science/
                :   Error: some fields have quotes that give it problems.
                    Found this:
                        https://stackoverflow.com/questions/21527057
                            /python-parse-csv-ignoring-comma-with-double-quotes
                    which uses,
                        csv.reader(lines, quotechar='"', delimiter=',',
                            quoting=csv.QUOTE_ALL, skipinitialspace=True):
                    No luck.
                    Copy to junk.csv and remove most lines. It works. I don't
                    know which line is giving it trouble. Continue for now.
                :   I really want to use csv.DictReader().
                :   If I want to read in energy as a numeric, I might
                    have to switch the Pandas method.
                    But I don't have Pandas. Better get it.
                        https://pandas.pydata.org/docs/getting_started
                            /install.html
                    But this says,
                        For users that are new to Python, the easiest way to
                        install Python, pandas, and the packages that make up
                        the PyData stack (SciPy, NumPy, Matplotlib, and more) is
                        with Anaconda, a cross-platform (Linux, macOS, Windows)
                        Python distribution for data analytics and scientific
                        computing. Installation instructions for Anaconda can be
                        found here.
                    It looks like getting Pandas is going to complicated and
                    require decisions. Perhaps, for now, I should convert the
                    energy string to a float:
                        >>> float(row['energy'])
                            1.0
                :   The offending title is
                        Del’s Bells
                    The apostrophe is a special character. Replace them in
                    music_performance_repertoire files with the single
                    quote, "'".
                :   I now have a list of dictionaries:
                        >>> len(songs)
                        83
                        >>> songs[79]['title']
                        'The Power Of Love'
                        >>> songs[79]['energy']
                        8.0
                        >>> songs[79]['data']
                        {'artist': 'Huey Lewis',
                         'energy': '8',
                         'genre': 'classic hits',
                         'guitar': '618e',
                         'song': 'The Power Of Love',
                         'technique': 'strum',
                         'type': 'loop w FX',
                         'unplugged': 'yes'}
        -   Now I can import songlist.txt, which contains some misspelled
            titles, and get the corresponding songs.
            >   Start with one: 'Addisonls Walk'
            >   Expand. scratch.py now has a snippet that reads in the
                repertwaar as well as songlist.txt, loops through songlist,
                matches with titles in repertwaar, and prints the best score
                and the next-best score:
                    partial_match_title_a.png
                All matching scores are 70%, and all next-best scores are
                zero.  But does zero make sense? I am only testing for the
                occurrence of two characters.
                    >>> match_score('Time After Time', 'Time In A Bottle')
                        35.714285714285715
                Some nonzero LastScore values should occur.
                Oops, found the bug. Try again:
                    partial_match_title_b.png
                The best false match is 57.1% (for The Wind & The Wheat),
                and the worst true match is 78.6% for Addison's Walk.
                But is it really right? I had better capture the false-match
                song.
                    partial_match_title_c.png
                OK, now I can see that all of the matches are correct even
                though some false matches score pretty high.
                Is that important? I can cut the search off if I find a
                score exceeding a threshold of, say, 70%. Or I can let it find
                the best. The number of iterations is the number of songs
                played in a gig times the number in the repertoire.
                I don't see this exceeding about 50*100 = 5,000. No big deal.
                Find the best.
            >   Commit & push

                                            Tuesday, May 14, 2024 (10:42 AM)
    *   Back to reverse_songlist.py: Get it to use the Repertwaar for
        correct spellings.
        -   Prototype in scratch.py.
        -   Port code to reverse_songlist.py
            IT WORKS!!
        -   Commit & push

    *   Another easy tool: Reorder the Repertwaar based on last gig:
        move songs from last gig (songlist.txt) to bottom of the Repertwaar to
        create a prioritized list that deprioritizes most recently played at a
        given venue.
        -   I actually used a Lambda function!!
            The Repertwaar is a list with the sort() method that accepts
            a sorting key.
            sort the Repertwaar by title:
                repertwaar.sort( key = lambda s: s['title'] )
            where s is a song within repertwaar. But it is a dictionary,
            so extract the title to use as a sorting key.
            This approach could be used to sort the Repertwaar
            on ANY field:
                repertwaar.sort( key = lambda s: s['energy'] )
            or,
                repertwaar.sort( key = lambda s: s['data']['genre'] )

    *   Calculate the Gig Energy Index as the RMS of the song energies.
        -   It works.
        -   Add it to reverse_songlist.py to get it for every future
            gig.
            >   Some notable gig energies:
                    Sullivan's 2/9/24               6.2
                    Sullivan's 3/29/24              7.3     Definite increase!
                    Innkeepers 5/11/24              5.8
                    Blue Margaritas 5/5/24          5.4
                    Germantown Spring Fling 5/4/24  5.3
                    Orange Cup 4/21/24              5.5
                    Café Santa Rosa 4/12/24         4.3
                    Opie’s 4/6/24                   6.2
                    Hidden Hills 3/30/24            5.5
                    Market Alley Wines 3/23/24      5.8
        -   Commit & push

                                            Wednesday, May 15, 2024 (1:48 PM)
    *   Back to reordering the Repertwaar. I am going to be using this
        regularly, so make it its own script, reorder_repertoire.py.
        -   It works great! I created a reordered repertwaar for Michael's
            Friday night.
        -   Commit & push


                                            Thursday, May 16, 2024 (12:02 PM)
+   Read OneNote data with Python.

    *   Study
        -   https://stackoverflow.com/questions/34622471
                /how-to-access-download-onenote-notebook-with-python
            This is old and has dead links.
        -   https://www.quora.com/Can-you-read-OneNote-data-with-Python
            This is worth studying.
            >   It contains a link:
                    https://learn.microsoft.com/en-us/graph
                        /integrate-with-onenote
                But it feels overwhelming with lots of dead ends.
                And it does not discuss Python.
        -   https://www.codeproject.com/Articles/5318953
                /OneNote-to-Markdown-Using-Python-and-the-Microsoft
            This might have code examples, but I will have to dig deep.
        -   This one costs money
                https://www.cdata.com/kb/tech/onenote-python-petl.rst
            and I can't really tell if or how it will get me there.
        -   This one
                https://github.com/DissectMalware/pyOneNote
            says it just dumps everything into a directory. But in what
            format?
        -   This one
                https://github.com/varunsrin/one-py
            says,
                "OneNote is an object model class that lets you read content and
                hierarchy from the OneNote application. It exposes them as
                native python types so you can read OneNote data without having
                to muck around with the underlying COM interfaces"
            but it is written for
                Windows 7 with Python 3.x
                OneNote 2013 or 2010 with your notebooks open
            and likely to not work.
        -   This one
                https://www.cdata.com/kb/tech/onenote-python-pandas.rst
            claims to make it simple, but the example code has huge strings
            with no clue as to how to build them. It says,
                "OneNote uses the OAuth authentication standard. To authenticate
                using OAuth, you will need to create an app to obtain the
                OAuthClientId, OAuthClientSecret, and CallbackURL connection
                properties. See the Help documentation for more information."
            What help documentation? OneNote??
        -   I fear this is simply out of scope.

                                                Friday, May 17, 2024 (10:04 AM)
    *   Can I export the pages to text files and read them?
        -   File:export does not offer text. If offers
                    .one
                    .docx
                    .doc
                    .pdf
                    .xps
                    .mht (web page)
            >   Try some on page "Tres Rojas 9/10/23"
                It has several images which increase file size.
                :   Create a subfolder, 'gigfiles'.
                :   .mht (web page)
                    The page gets saved as
                    "Tres Rojas 91023.mht". It is huge (8MB) and binary.
                :   .xps: "Tres Rojas 91023.xps". 1.5MB. Also binary.
                :   .doc: 'Tres Rojas 91023.doc'. 6MB. Big.
                    It has a binary header, but the text body is readily
                    available. Perhaps I could find a way to skip the header?
                :   .docx: 'Tres Rojas 91023.docx'. 4MB. Binary.
                    #   This might help:
                        Google('convert word doc to text python')
                            https://stackoverflow.com/questions/62859658
                                /how-to-convert-docx-to-txt-in-python
                            https://stackoverflow.com/questions/42482
                                /best-way-to-extract-text-from-a-word-doc
                                -without-using-com-automation
                :   .pdf: 'Tres Rojas 91023.pdf'. 1MB. Smallest file. Binary.
                    #   This might help:
                            https://www.geeksforgeeks.org
                                /extract-text-from-pdf-file-using-python/
                        The process looks easy. I like this one.
        -   Read 'Tres Rojas 91023.pdf' using pypdf from
                    https://www.geeksforgeeks.org
                        /extract-text-from-pdf-file-using-python/
            >   How to install?
                :   It says to use
                        pip install pypdf
                    in terminal. Hmmm. Point the terminal at the Python 3.12
                    folder,
                        C:\Users\Owner\AppData\Local\Programs\Python\Python312\
                    Error:
                        'pip' is not recognized as an internal or external
                        command, operable program or batch file.
                    Found this:
                        https://stackoverflow.com/questions/23708898
                            /pip-is-not-recognized-as-an-internal-or-external
                            -command
                    which says,
                        For Windows, when you install a package, you type:
                        python -m pip install [packagename]
                    IT WORKED!
                        install_pypdf_a.png
                    Of course, the terminal is in the python folder
                    so the correct python version gets called.
            >   Try it in scratch.py
                :   It works, but it discards line returns, which are
                    needed to isolate blocks so that I can find the
                    list of songs. It also inserts extra stuff at the
                    bottom of the page:
                        'Brandy \n'
                        'Those Who Wait \n'
                        'The Wind & The Wheat Tres Rojas 9/10/23\n'
                        'Sunday, September 10, 2023 5:19 PM\n'
                        '   Performances Page 1    ')
            >   Probably not the best solution. The next best might be to
                read the current format of Word, which may come in handy
                later.
        -   Read 'Tres Rojas 91023.docx'.
            >   Research best approach. Most point to python-docx:
                    https://python-docx.readthedocs.io/en/latest/
                See sample code in
                    https://stackoverflow.com/questions/29309085
                        /read-docx-files-via-python
            >   Install via terminal in python312 folder with,
                    python -m pip install python-docx
                Try
                    >>> import docx
                Success. Try
                    >>> doc = docx.Document(
            >   Try it out.
                Error:
                    docx.opc.exceptions.PackageNotFoundError:
                    Package not found at 'Tres Rojas 91023.docx'
                google(python-docx PackageNotFoundError)
                    This error simply means there is no .docx file at the
                    location you specified.
                Now it works quite nicely, but line returns are '\xa0'.
                Nop, not all of them:
                    'Lisa said she would reach out in January or February ...'
                    'next year. ',                                        ...
                    'Calendar reminder for 1/8/24.',                      ...
                    ' ',                                                  ...
                    '2/1/23 Messenger with Lisa. ',                       ...
                    'Play 1-4PM. ',                                       ...
                    '3 * $75 = $225',                                     ...
                    ' ',                                                  ...
                    '6/8/23 Running into his system: Send him the quarter-...
                    'volume knob assigned to it. Use XLR output to Bose, a...
                    'the Bose or using the Global EQ level. ',
                    '8/28/23 Create event so I can invite people.',
                    '9/2/23 Boost event, $10',
                    '\xa0',
                    '\xa0',
                    'The Mission ',
                    'As Warm As Tears ',
                    'Morning Snow ',
                    'Metamorphosis ',
                    'If You Could Read My Mind ',
                    'In Your Peace / I Love You Lord ',
                Some discussion of cleaning it up at
                    https://stackoverflow.com/questions/10993612
                        /how-to-remove-xa0-from-string-in-python
                Use
                    import unicodedata
                    unicodedata.normalize('NFKD',docpara.text)
                It works.
            >   Can I isolate blocks of text? allText is a list of strings
                where each element is a line. Blocks are separated
                by a line containing ' '.
                It works great. One of the blocks is now the song list.
            >   Can I detect a song list?
                :   I am going to have to encapsulate some of these
                    functions that I am using in multiple places:
                        reading the repertoire
                        finding matches in a song list
                        scoring the match between two strings




================================================================================

+   TO DO:
    *   How about a gig energy index? Consider RMS(energy)
    *   Read from OneNote
    *   Song database
        -   in SQL?
            >   Microsoft has a free SQL
                    https://www.microsoft.com/en-us
                        /sql-server/sql-server-downloads
        -   track plays
        -   Match titles


